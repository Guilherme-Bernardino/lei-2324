# Object-Oriented Programming 2022/2023

## Lab Sheet #9

## Objectives

- Introduction to the use of exceptions, IO, and serialization.

## Program

The main goal of the solution is to develop a system to support an online coffee shop. At this stage, the system allows the registration of accounts and sales management of several types of coffees. The goal is to minimize vulnerabilities to failures caused by data entry errors, automate some processes and have the ability to back up data.

## Implementation rules

- Accept the GitHub Classroom assignment [**here**](https://classroom.github.com/a/MEjA392c)
- Clone the repository generated by GitHub Classroom
- Use the BlueJ IDE.
- Implement the required code and test at the end of each level.
- **Update the program version in the repository at the minimum at the end of each level** (it is advised at the end of each successfully implemented and tested feature). It is not necessary to include the compiled files (.class extension) in the version.
- Use the coding conventions adopted for the Java language (see **Notes**).

## Implementation

### Level 1:

1. Create an enumerated type `ErrorCode` with the data from the Table. Implement the given explanatory texts, in the `toString()` method of this enumerate:
  
  | | Identifier | | Description |
  |:--------------------------------:|:--------------------------------------------------------------------:|
  | MEMBER_DOES_NOT_EXISTS | The user is not logged in |
  | MEMBER_ALREADY_EXISTS The login name is already in use.
  | LOGIN_NAME_CANT_BE_NULL | User name must be supplied | |
  | LOGIN_NAME_MUST_BE_BIGGER | User name must be composed of at least 5 characters |
  | MEMBER_NIF_CANT_BE_NULL | User's TIN must be provided |
  | MEMBER_NIF_IS_INCORRECT | User's TIN is incorrect |
  | SHOPPING_CART_IS_EMPTY | Shopping cart is empty |
  | The number of boxes must be positive | | NUMBER_OF_BOXES_MUST_BE_POSITIVE
  | FILE_CANT_BE_NULL_OR_EMPTY | The file to print cannot be empty or null |

2. Implement the class `CoffeeShopIllegalArgumentException`, which inherits from `IllegalArgumentException` with an attribute of type `ErrorCode` and a method to get the error code of the exception. Also create the constructor which has a single parameter of type `ErrorCode`.

### Level 2

1. In the `CoffeeShop` class implement the auxiliary method `searchMember()` which gets a `String` with the login name in the member collection. If it finds it returns the Member with this username, otherwise it returns the value *null*.

2. Implement the `createMemberAccount()` method, which receives the data needed to instantiate a new member (`Member`). First check if a new member already exists in its collection and if so throw the specific `CoffeeShopIllegalArgumentException` exception.

3. Implement the `getMember()` method, which is named login. It looks for and returns the existing member in its collection. If it doesn't exist, it throws a specific exception of type `CoffeeShopIllegalArgumentException`.

4. Also implement the `addToCart()` method, which receives:
  
  - Login name - `string` with the username;
  - Number of boxes - Number of boxes to add to the shopping cart;
  - Type of coffee - Type of coffee to add to the shopping cart;
  
  This method should add to that member's cart the quantity of boxes of coffee, of the selected type.

5. Further implement the `finishPurchase()` method, which is named login and returns a `Purchase`. This purchase should consist of all the items in that member's shopping cart. This purchase should also be added to the store's shopping list. If the member's shopping cart is empty, it should throw a specific exception of type `CoffeeShopIllegalArgumentException`.

### Level 3

1. Now redefine some supplied classes to contain validations, so that a `CoffeeShopIllegalArgumentException` is thrown with the appropriate error code:
  
  - In the `Member` class:
    
    - Create the auxiliary method `String validateName(String name)`, which should be called in the class constructor and checks that the name is not null or empty, and if, the username consists of at least 5 characters.
    - Create the auxiliary method `String validateNif(String nif)`, which must be called in the constructor of the class and checks that the NIF is not null or empty, and that, it is composed of 9 characters.
    - In the `Purchase` class:
      - In the constructor check that the shopping cart of the received member is not empty.
  
  - In the `ShoppingCart` class:
    
    - In the `addCoffeToCard()` method existing in the class, add a check that checks that at least one box is being added to the shopping cart.  

2. To test the classes, in the `main` method of the `AppStart` class a store and add members, in order to test, throwing as many exceptions as possible implemented in the code. Also use one of these members to add coffee boxes to your shopping cart and checkout, in order to test all the code you have developed. Capture each of the exceptions.

### Level 4

1. Create the `getBalance()` method, in the `CoffeeShop` class, which returns the information regarding the time at which the information is generated and, the value of the total sales made so far. Whenever possible, opt for functional programming. 

2. Create the abstract class `CoffeeShopFileHandler`.

3. Implement a static method `printToFile` that receives as parameters:
  
  - `fileName` - String with the name of the file;
  - `textToSave` - String with the text to save in the text file;
  
  The content (textToSave) cannot be null or empty. If it is, it throws the specific exception of type `CoffeeShopIllegalArgumentException`.

4. In the **main** method, test the method for saving the store's balance to a file. The file should be stored as "*PurchasesRecord.txt*".
  
  Also test the saving of the last purchase information (the file name consists of the prefix "*Invoice_*" and the purchase number, for example "*Invoice_1.txt*").

### Level 5

Implement in the abstract class `CoffeeShopFileHandler` a static method `saveShop()` that receives as parameters a `String` with the filename and the instance of `CoffeeShop` to be saved in a file using data serialization.
  
  Note: implement the **Serializable** interface in all classes you consider necessary.

2. Also implement a static `loadShop` method that gets the name of the file to read an instance of `CoffeeShop` from.

3. In the `main` method store a store with at least one purchase made, and its members, in the file "**shop.backup**", read from the file and print to the console the balance of the store you read from the file, in order to get the stored information: 

**Notes**:

For identifiers follow the conventions adopted normally, in particular:

1. The **camelCase** notation for the name of local variables and identifiers for attributes and methods.
2. The **PascalCase** notation for class names.
3. Do not use the '_' symbol or abbreviations for identifiers.